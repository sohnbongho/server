syntax = "proto3";

import "protoc-23.2-win64/include/google/protobuf/timestamp.proto";

package Messages;

/*****************************************************************
전체 메시지 : 클라이언트와 서버간 모든 메시지는 이곳에 추가하여야 한다.
구글 프로토 버퍼는 상속 개념이 없기에 패킷을 받는 부분에서 분리를 해야 하기 때문이다.

ProtoBuf의 기본 숫자 타입은 다음과 같습니다:
int32
int64
uint32
uint64
sint32 (ZigZag encoding을 사용하여 음수를 효과적으로 인코딩)
sint64 (ZigZag encoding을 사용하여 음수를 효과적으로 인코딩)
fixed32 (Always 4 bytes, more efficient than int32 if values are often greater than 2^28.)
fixed64 (Always 8 bytes)
sfixed32 (Always 4 bytes)
sfixed64 (Always 8 bytes)
*****************************************************************/
message MessageWrapper {  
	int32 message_size = 1;
	oneof payload {
		ConnectedResponse connected_response = 11;
		
		/**** Login Server ****/
		LoginDirectRequest login_direct_request = 12;
		LoginDirectResponse login_direct_response = 13;
		/**** end Login Server ****/

		/**** Lobby Server ****/
		EnterLobbyRequest enter_lobby_request = 21;
		EnterLobbyResponse enter_lobby_response = 22;

		// 착장 정보
		EquipItemRequest equip_item_request = 23;
		EquipItemResponse equip_item_response = 24;

		// 인벤 정보 요청
		InvenRequest inven_request = 25;
		InvenAccessoryResponse inven_accessory_response = 26;
		InvenSetResponse inven_set_response = 27;
		InvenItemResponse inven_item_response = 28;

		// 맵에 입장
		MapEnterRequest map_enter_request = 29;
		MapEnterResponse map_enter_response = 30;

		SayRequest say_request = 31;
		SayResponse say_response= 32;
		/**** end Lobby Server ****/
	}
}

// 연결 성공
message ConnectedResponse {  
  int32 index = 1;  
}

///////////// 서버 로그인

message LobbyInfo {
  int32 id = 1;
  int32 world_idx = 2;
  string name = 3;
  string Ip = 4;  
  int32 port = 5;
}

message LoginDirectRequest {  
	string account_id = 1;  
	string pass = 2;
}

message LoginDirectResponse {  
	int32 result = 1;
	uint64  user_seq = 2;  
	int32 seleted_lobby_id = 3;
	repeated LobbyInfo lobby_infos = 4;
}

/**** Lobby Server ****/
message ZoneInfo {
  int32 id = 1;
  string name = 2;
  string Ip = 3;  
  int32 port = 4;
}

// 로비 입장
message EnterLobbyRequest {  
  uint64  user_seq = 1;
}

message EnterLobbyResponse {  
  repeated ZoneInfo zone_infos = 1;  
}

// 착장 정보
message EquipItemRequest {
}

message EquipItemResponse {  
  string nickname = 1;
  string alias = 2;
  int32 class = 3;

  int32 gender = 4;
  int32 head_parts = 5;
  int32 face_parts = 6;
  int32 upperbody_parts = 7;
  int32 lowerbody_parts = 8;
  int32 shoes_parts = 9;

  int32 money = 10;
  int32 heart = 11;
  int32 star = 12;
  int32 cash = 13;

  uint64  exp = 14;
  int32  level = 15;
}

// 인벤 정보 요청
message InvenRequest {  
  
}

message Item { 	
	uint64 char_seq = 1;	
	int32 item_seq = 2;
	int32 item_type = 3;
	uint64 item_uid = 4;
	int32 is_use = 5;
	int32 is_hold = 6;
	int32 by_class = 7;
	uint64 couple_uid = 8;
	google.protobuf.Timestamp expiration_date = 9;
	int32 favorites = 10;
}

message InvenAccessoryResponse {  
  repeated Item items = 1;
}

message InvenSetResponse {  
  repeated Item items = 1;
}

message InvenItemResponse {  
  repeated Item items = 1;
}

// 맵 입장
message MapEnterRequest {    
  int32 map_index = 1;
}

message MapEnterResponse {  
  int32 map_index = 1;
}

// 채팅 메시지
message SayRequest {  
  uint64 user_seq = 1;
  string user_id = 2;
  string message = 3;
}

message SayResponse {  
  string user_id = 1;
  string message = 2;
}

